<!DOCTYPE html>
<html>
<head>
    <title>Angular Tablesort - Advanced</title>
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.6/css/bootstrap.min.css">
    <link rel="stylesheet" href="tablesort.css"/>
</head>
<body>

<div ng-app="myApp" class="container" ng-cloak>
    <div ng-controller="tableTestCtrl">
        
        <div class="alert alert-info">
            <h4><span class="glyphicon glyphicon-info-sign"></span> About Pagination</h4>
            <p>This demo page has examples that use the <a href="http://angular-ui.github.io/bootstrap/#/pagination" class="alert-link" target="_blank">Angular-UI Bootstrap pagination directive</a>, but really any pagination directive could be used here</p>
        </div>
        
        <h2>With configured filtering & paging</small></h2>
        <table class="table table-striped" ts-wrapper>
            <thead>
                <tr>
                    <th>Select</th>
                    <th ts-criteria="Id" ts-filter>Id</th>
                    <th ts-criteria="Name|lowercase" ts-filter ts-default>Name</th>
                    <th ts-criteria="Price|parseFloat" ts-filter>Price</th>
                    <th ts-criteria="Quantity|parseInt" ts-filter>Quantity</th>
                </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in tableOneItems track by item.Id"
                ng-class="{'active':item.Selected}"
                ts-repeat>
                <td><input type="checkbox" ng-model="item.Selected" /></td>
                <td>{{item.Id}}</td>
                <td>{{item.Name}}</td>
                <td>{{item.Price | currency}}</td>
                <td>{{item.Quantity}}</td>
            </tr>
            </tbody>
        </table>
        
        <hr />
        
        <h2>Disabled filtering & paging</h2>
        <table class="table table-striped" ts-wrapper ts-filtering-enabled="false" ts-pagination-enabled="false">
            <thead>
                <tr>
                    <th>Select</th>
                    <th ts-criteria="Id" ts-filter ts-default>Id</th>
                    <th ts-criteria="Name|lowercase" ts-filter>Name</th>
                    <th ts-criteria="Price|parseFloat" ts-filter>Price</th>
                    <th ts-criteria="Quantity|parseInt" ts-filter>Quantity</th>
                </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in tableTwoItems track by item.Id"
                ng-class="{'active':item.Selected}"
                ts-repeat>
                <td><input type="checkbox" ng-model="item.Selected" /></td>
                <td>{{item.Id}}</td>
                <td>{{item.Name}}</td>
                <td>{{item.Price | currency}}</td>
                <td>{{item.Quantity}}</td>
            </tr>
            </tbody>
        </table>

        <hr />
        
        <h2>Disabled filtering & different per-page options</h2>
        <table class="table table-striped" ts-wrapper ts-filtering-enabled="false" ts-per-page-options="[20,40,60]" ts-per-page-default="40">
            <thead>
                <tr>
                    <th>Select</th>
                    <th ts-criteria="Id" ts-filter>Id</th>
                    <th ts-criteria="Name|lowercase" ts-filter ts-default>Name</th>
                    <th ts-criteria="Price|parseFloat" ts-filter>Price</th>
                    <th ts-criteria="Quantity|parseInt" ts-filter>Quantity</th>
                </tr>
            </thead>
            <tbody>
            <tr ng-repeat="item in tableThreeItems track by item.Id"
                ng-class="{'active':item.Selected}"
                ts-repeat>
                <td><input type="checkbox" ng-model="item.Selected" /></td>
                <td>{{item.Id}}</td>
                <td>{{item.Name}}</td>
                <td>{{item.Price | currency}}</td>
                <td>{{item.Quantity}}</td>
            </tr>
            </tbody>
        </table>
        
    </div>
</div>

<script src="https://ajax.googleapis.com/ajax/libs/angularjs/1.5.5/angular.js"></script>
<script src="https://cdnjs.cloudflare.com/ajax/libs/angular-ui-bootstrap/1.3.2/ui-bootstrap-tpls.min.js"></script>
<script src="js/angular-tablesort.js"></script>
<script>
    function getFakeData(count){
        var items = [];
        var charset = "abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ";
        function getRandLetter(){
            return charset.charAt(Math.floor(Math.random() * charset.length));
        }
        for(var i = 0; i < count; i++){
            var idStr = (i < 10 ? "0" + i : i).toString();
            var nameStr = getRandLetter() + getRandLetter() + getRandLetter();
            var priceStr = (Math.random()*100).toFixed(2);
            var qty = Math.floor(Math.random() * (25 - 1 + 1) + 1);
            items.push({
                Id: idStr,
                Name: nameStr,
                Price: priceStr,
                Quantity: qty,
                selected: false
            });
        }
        return items;
    }
    
    angular
        .module( 'myApp', ['tableSort', 'ui.bootstrap'] )
        .controller( "tableTestCtrl", function tableTestCtrl($scope)  {
            //Generate some fake data
            $scope.tableOneItems = getFakeData(10000);
            $scope.tableTwoItems = getFakeData(12);
            $scope.tableThreeItems = getFakeData(100);
        });

    angular
        .module('myApp')
        .config(['tableSortConfigProvider', function(tableSortConfigProvider){
            //Globally configured filtering & pagination templates
            
            /* Template Tokens - all are replaced by Angular expressions
             * TOTAL_COUNT         - The number for the total count of items in the table
             * FILTERED_COUNT      - The number for the total count of items in the table after the filter has been applied
             * FILTER_STRING       - The string used for the `ng-model` of the text filter
             * PER_PAGE_OPTIONS    - The array of numbers for the verious page size options
             * ITEMS_PER_PAGE      - The number for the selected number of items to display per page (the selected item from PER_PAGE_OPTIONS)
             * CURRENT_PAGE_NUMBER - The number for the page that is currently being viewed
             * CURRENT_PAGE_RANGE  - The number for the current viewable range of pages
             */
            
            var pagerString = "<div class='pull-right'>"
            pagerString +=      "<small class='text-muted'>Showing {{CURRENT_PAGE_RANGE}} of ";
            pagerString +=        "<span ng-if='FILTERED_COUNT === TOTAL_COUNT'>{{TOTAL_COUNT | number}} items</span>";
            pagerString +=        "<span ng-if='FILTERED_COUNT !== TOTAL_COUNT'>{{FILTERED_COUNT | number}} items (filtered from {{TOTAL_COUNT | number}})</span>"
            pagerString +=      "</small>&nbsp;"
            pagerString +=      "<uib-pagination style='vertical-align:middle;' ng-if='ITEMS_PER_PAGE < TOTAL_COUNT' ng-model='CURRENT_PAGE_NUMBER' total-items='FILTERED_COUNT' items-per-page='ITEMS_PER_PAGE' max-size='5' force-ellipses='true'></uib-pagination>";
            pagerString +=      "&nbsp;"
            pagerString +=      "<div class='form-group' style='display:inline-block;'><select class='form-control' ng-model='ITEMS_PER_PAGE' ng-options='opt as (opt + \" per page\") for opt in PER_PAGE_OPTIONS'></select></div>"
            pagerString +=    "</div>";
            pagerString +=    "<div class='clearfix'></div>";
            tableSortConfigProvider.paginationTemplate = pagerString;
            
            var filterString = "<div class='pull-right'>"
            filterString +=      "<div class='form-group' style='display:inline-block;'>";
            filterString +=        "<input type='search' class='form-control' placeholder='filter items' ng-model='FILTER_STRING'/>";
            filterString +=      "</div>";
            filterString +=    "</div>";
            filterString +=    "<div class='clearfix'></div>";
            tableSortConfigProvider.filterTemplate = filterString;
        }
    ]);
</script>
</body>
</html>
